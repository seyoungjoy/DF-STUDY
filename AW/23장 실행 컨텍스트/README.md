# 23장 실행 컨텍스트

---

## 23.1 소스코드의 타입

1. 전역 코드
2. 함수 코드
3. eval 코드
4. 모듈 코드

## 23.2 소스코드의 평가와 실행
```js
var x;
x = 1;
```
1. 변수 선언문 `var x;` 먼저 실행(실행 컨텍스트 스콥에 등록되며 undefined로 초기화) [소스코드평가]
2. 스콥에 `var x` 가 등록되어 있는지 확인 [소스코드 실행 과정]
3. `x = 1;` 실행 및 컨텍스트에 등록

## 23.3 실행 컨텍스트의 역할 
1. 전역 코드 평가
   1. 선언문만 먼저 실행
   2. 전역 변수와 전역 함수가 컨텍스트 스콥에 등록
   3. 전역 변수와 함수는 전역 객체의 프로퍼티와 매서드로 등록
2. 전역 코드 실행
   1. 런타임이 시작되어 전역코드 순차 실행
   2. 전역 변수에 값 할당 및 함수 호출
   3. 함수가 호출되면 일시정지하고 함수 내부로 들어감
3. 함수 코드 평가
   1. 매개 변수와 지역변수 선언문 실행 및 컨텍스트 지역 스콥 등록
   2. arguments 객체 생성 및 this 바인딩 
4. 함수 코드 실행
   1. 매개변수 및 지역 변수에 값 할당 (console.log 호출 기준)
   2. console 식별자 검색
   3. log 프로퍼티 검색 (프로토타입 체인)
   4. console.log(표현식) 의 표현식 평가
   5. 함수 실행 종료후 호출 이전으로 돌아가 마저 전역 코드 실행

- **스코프, 식별자, 코드실행 순서를 관리하는것이 실행 컨텍스트이다.**

## 23.4 실행 컨텍스트 스택
- 여러 실행 컨텍스트가 중첩될 때, 스택으로 관리되어짐
1. 중첩된 함수가 있을 시, 전역코드 평가후 전역 실행 컨텍스트 생성 후 스택에 푸시
2. 전역 함수가 호출되면 전역 코드 실행은 일시정지하고 첫번째 댑스 함수로 이동 및 지역변수와 중첩함수 컨텍스트 등록 후 스택에 푸시
3. 전역 함수 일시중지 후 중첩함수 평가 후 컨텍스트 생성 및 지역 변수와 함수 등록 및 푸시
4. 중첩함수 종료
5. 전역 함수 복귀 
6. 전역 코드로 복귀
7. 종료
## 23.5 렉시컬 환경
- 렉시컬 환경은 명세서에만 존재한다.
- 자바스크립트가 어떻게 동작하는지 설명하는데 쓰이는 이론상의 객체
- 코드를 사용해 직접 렉시컬 환경을 얻거나 조작하는 것은 불가능
```js
// 렉시컬 환경
실행컨텍스트 : {
  렉시컬 환경 컴포넌트: {
    렉시컬 환경 {
      환경 레코드: {
        // 모든 지역변수를 프로퍼티 {key, value}로 저장한 객체이다.
      }
    },
    외부 렉시컬 환경 참조 : 상위 스코프 참조
    // 글로벌 스코프에서는 상위 스코프가 없으므로 null을 참조
  },
  변수 환경 컴포넌트 : {
    // 렉시컬 환경을 복사한 것으로 초기값이 동일하다 , 실행단계에서 참조하는 것은 환경레코드이다.
    // 전역 렉시컬환경의 경우 null을 참조한다.
  }
}

// outerFunc() {
    innerFunc() {
      var x = 10;
    }
}
```
- 변수선언이 실행되면 변수 식별자가 렉시컬 환경레코드에 키(key)로 등록되고
- 변수할당이 일어나면 렉시컬 환경레코드의 변수 식별자에 해당하는 값을 반환한다.
> 즉 스코프체인은 렉시컬환경을 단반향으로 연결.
[참조](https://junghyeonsu-dev.vercel.app/posts/Execution-context)
# 끝